diff -rupN seafile-3.1.7-server.orig/fileserver/Makefile.am seafile-3.1.7-server/fileserver/Makefile.am
--- seafile-3.1.7-server.orig/fileserver/Makefile.am	2014-10-16 05:30:04.000000000 +0200
+++ seafile-3.1.7-server/fileserver/Makefile.am	2014-11-21 14:34:36.745268286 +0100
@@ -6,7 +6,6 @@ AM_CFLAGS = -DPKGDATADIR=\"$(pkgdatadir)
 	-I$(top_srcdir)/lib \
 	-I$(top_builddir)/lib \
 	-I$(top_srcdir)/common \
-	-I$(includedir) \
 	@CCNET_CFLAGS@ \
 	@SEARPC_CFLAGS@ \
 	@GLIB2_CFLAGS@ \
@@ -50,6 +49,7 @@ fileserver_LDADD = -levent -levhtp @SSL_
 	$(top_builddir)/lib/libseafile.la \
 	$(top_builddir)/common/cdc/libcdc.la \
 	@SEARPC_LIBS@ @JANSSON_LIBS@ @ZDB_LIBS@ @CURL_LIBS@ \
-	@LIBARCHIVE_LIBS@ ${LIB_WS32} @ZLIB_LIBS@
+	@LIBARCHIVE_LIBS@ ${LIB_WS32} @ZLIB_LIBS@ \
+	-liconv
 
 fileserver_LDFLAGS = @STATIC_COMPILE@
